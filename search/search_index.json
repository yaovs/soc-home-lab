{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"SOC Home Lab","text":""},{"location":"#overview","title":"\ud83d\udccc Overview","text":"<p>This project demonstrates a hands-on Security Operations Center (SOC) home lab designed to practice blue team skills such as log collection, monitoring, detection, and basic incident response.</p>"},{"location":"#lab-architecture","title":"\ud83e\uddf1 Lab Architecture","text":"<ul> <li>Windows Server (Domain Controller)</li> <li>Windows 10 (Endpoint)</li> <li>Linux (SIEM / Log Collector)</li> <li>VirtualBox / VMware</li> </ul>"},{"location":"#tools-technologies","title":"\ud83d\udee0 Tools &amp; Technologies","text":"<ul> <li>Windows Event Logs</li> <li>Sysmon</li> <li>Wazuh / Splunk (planned)</li> <li>Linux (Ubuntu)</li> <li>PowerShell</li> <li>MITRE ATT&amp;CK</li> </ul>"},{"location":"#use-cases-implemented","title":"\ud83d\udd0d Use Cases Implemented","text":"<ul> <li>Failed login detection</li> <li>Brute-force attack simulation</li> <li>Suspicious PowerShell execution</li> <li>User account anomalies</li> </ul>"},{"location":"#detection-monitoring","title":"\ud83d\udcca Detection &amp; Monitoring","text":"<ul> <li>Centralized log collection</li> <li>Custom alert rules</li> <li>Basic correlation logic</li> </ul>"},{"location":"#screenshots","title":"\ud83e\uddea Screenshots","text":"<p>Screenshots will be added as the lab progresses.</p>"},{"location":"#lessons-learned","title":"\ud83d\udcda Lessons Learned","text":"<ul> <li>Importance of proper logging</li> <li>How SIEM correlates events</li> <li>Blue Team detection mindset</li> </ul>"},{"location":"#roadmap","title":"\ud83d\ude80 Roadmap","text":"<ul> <li>[ ] Install SIEM</li> <li>[ ] Configure log forwarding</li> <li>[ ] Create detection rules</li> <li>[ ] Simulate attacks</li> <li>[ ] Document findings</li> </ul> <p>\ud83e\udde0 Author: Ziya Shalbuzov \ud83c\udfaf Focus: Blue Team | SOC | Cybersecurity Analyst</p>"},{"location":"roadmap/","title":"Test Page","text":""},{"location":"roadmap/#roadmap","title":"\ud83d\ude80 Roadmap","text":""},{"location":"roadmap/#short-term","title":"Short Term","text":"<ul> <li>Add Wazuh SIEM</li> <li>Create Windows failed login detection</li> <li>Map detections to MITRE ATT&amp;CK</li> </ul>"},{"location":"roadmap/#mid-term","title":"Mid Term","text":"<ul> <li>Add Sysmon detections</li> <li>Implement alert enrichment</li> <li>Add response playbooks</li> </ul>"},{"location":"roadmap/#long-term","title":"Long Term","text":"<ul> <li>Publish SOC portfolio</li> <li>Add dashboards &amp; screenshots</li> <li>Simulate real attack scenarios</li> </ul>"},{"location":"detections/suspicious-account-changes/suspicious-account-changes-detection/","title":"Suspicious User Account and Privilege Changes Detection","text":""},{"location":"detections/suspicious-account-changes/suspicious-account-changes-detection/#1-overview","title":"1. Overview","text":"<p>This detection identifies potentially malicious changes to user accounts and group memberships on Windows systems. Attackers frequently modify accounts to maintain persistence or escalate privileges after gaining access.</p> <p>Monitoring account management activity is critical for early detection of compromise.</p>"},{"location":"detections/suspicious-account-changes/suspicious-account-changes-detection/#2-detection-objective","title":"2. Detection Objective","text":"<ul> <li>Detect unauthorized account creation</li> <li>Identify privilege escalation attempts</li> <li>Detect persistence via group membership changes</li> </ul>"},{"location":"detections/suspicious-account-changes/suspicious-account-changes-detection/#3-log-sources","title":"3. Log Sources","text":"Source Description Windows Security Log Account and group management <p>Required Event IDs: - 4720 \u2013 User account created - 4722 \u2013 User account enabled - 4724 \u2013 Password reset attempt - 4728 \u2013 User added to security-enabled group - 4732 \u2013 User added to local group - 4726 \u2013 User account deleted</p>"},{"location":"detections/suspicious-account-changes/suspicious-account-changes-detection/#4-detection-logic","title":"4. Detection Logic","text":"<p>Trigger an alert when: - A new user account is created outside business hours - A user is added to Administrators or Domain Admins - Multiple account changes occur in a short time window - A disabled account is re-enabled unexpectedly</p>"},{"location":"detections/suspicious-account-changes/suspicious-account-changes-detection/#high-risk-groups","title":"High-Risk Groups","text":"<ul> <li>Administrators</li> <li>Domain Admins</li> <li>Enterprise Admins</li> <li>Backup Operators</li> </ul>"},{"location":"detections/suspicious-account-changes/suspicious-account-changes-detection/#5-mitre-attck-mapping","title":"5. MITRE ATT&amp;CK Mapping","text":"Tactic Technique Persistence T1136 \u2013 Create Account Privilege Escalation T1078 \u2013 Valid Accounts Defense Evasion Account Manipulation"},{"location":"detections/suspicious-account-changes/suspicious-account-changes-detection/#6-severity-classification","title":"6. Severity Classification","text":"Scenario Severity Domain Admin added Critical Local admin added High Account created Medium Account deleted Low"},{"location":"detections/suspicious-account-changes/suspicious-account-changes-detection/#7-sample-event-details","title":"7. Sample Event Details","text":""},{"location":"detections/suspicious-account-changes/suspicious-account-changes-detection/#event-id-4728-user-added-to-group","title":"Event ID 4728 \u2013 User Added to Group","text":"<p>Important fields: - <code>MemberName</code> - <code>GroupName</code> - <code>SubjectUserName</code> - <code>TimeCreated</code></p>"},{"location":"detections/suspicious-account-changes/suspicious-account-changes-detection/#8-false-positives","title":"8. False Positives","text":"<p>Common benign activity: - IT onboarding processes - Group Policy automation - Legitimate admin maintenance</p>"},{"location":"detections/suspicious-account-changes/suspicious-account-changes-detection/#reduction-techniques","title":"Reduction Techniques","text":"<ul> <li>Exclude known admin accounts</li> <li>Restrict alerts to non-IT hours</li> <li>Monitor only high-risk groups</li> </ul>"},{"location":"detections/suspicious-account-changes/suspicious-account-changes-detection/#9-investigation-playbook","title":"9. Investigation Playbook","text":"<p>Analyst steps: 1. Identify the account that made the change 2. Confirm change approval with IT 3. Review recent login activity 4. Check source system and IP 5. Look for related suspicious behavior</p>"},{"location":"detections/suspicious-account-changes/suspicious-account-changes-detection/#10-response-actions","title":"10. Response Actions","text":""},{"location":"detections/suspicious-account-changes/suspicious-account-changes-detection/#immediate","title":"Immediate","text":"<ul> <li>Remove unauthorized group membership</li> <li>Disable suspicious accounts</li> <li>Reset affected credentials</li> </ul>"},{"location":"detections/suspicious-account-changes/suspicious-account-changes-detection/#follow-up","title":"Follow-up","text":"<ul> <li>Review audit logs</li> <li>Check for persistence mechanisms</li> <li>Document incident and root cause</li> </ul>"},{"location":"detections/suspicious-account-changes/suspicious-account-changes-detection/#11-detection-limitations","title":"11. Detection Limitations","text":"<ul> <li>Legitimate admin activity may trigger alerts</li> <li>Automation tools can cause noise</li> <li>Requires proper auditing policies enabled</li> </ul>"},{"location":"detections/suspicious-account-changes/suspicious-account-changes-detection/#12-improvement-ideas","title":"12. Improvement Ideas","text":"<ul> <li>Correlate with login anomalies</li> <li>Add change approval validation</li> <li>Monitor group membership drift over time</li> </ul>"},{"location":"detections/suspicious-account-changes/suspicious-account-changes-detection/#13-lessons-learned","title":"13. Lessons Learned","text":"<ul> <li>Account changes are high-value signals</li> <li>Privilege escalation often follows initial access</li> <li>Context and timing are key to detection accuracy</li> </ul>"},{"location":"detections/suspicious-powershell/suspicious-powershell-detection/","title":"Suspicious PowerShell Execution Detection","text":""},{"location":"detections/suspicious-powershell/suspicious-powershell-detection/#1-overview","title":"1. Overview","text":"<p>This detection identifies potentially malicious PowerShell activity based on script content, execution behavior, and known attacker techniques. PowerShell is frequently abused by attackers for execution, persistence, and lateral movement.</p> <p>This detection focuses on Script Block Logging to provide deep visibility into PowerShell commands.</p>"},{"location":"detections/suspicious-powershell/suspicious-powershell-detection/#2-detection-objective","title":"2. Detection Objective","text":"<ul> <li>Detect malicious or suspicious PowerShell commands</li> <li>Identify post-exploitation activity</li> <li>Reduce dwell time by alerting on attacker behavior</li> </ul>"},{"location":"detections/suspicious-powershell/suspicious-powershell-detection/#3-log-sources","title":"3. Log Sources","text":"Source Description Windows PowerShell Operational Log PowerShell execution details Security Log User context Sysmon (Optional) Process execution context <p>Required Event ID: - 4104 \u2013 PowerShell Script Block Logging</p>"},{"location":"detections/suspicious-powershell/suspicious-powershell-detection/#4-detection-logic","title":"4. Detection Logic","text":"<p>Trigger an alert when Event ID 4104 contains suspicious indicators such as: - <code>EncodedCommand</code> - <code>Invoke-Expression</code> - <code>DownloadString</code> - <code>FromBase64String</code> - <code>IEX</code> - <code>WebClient</code> - <code>Invoke-WebRequest</code> - <code>Invoke-Command</code></p>"},{"location":"detections/suspicious-powershell/suspicious-powershell-detection/#example-logic","title":"Example Logic","text":"<ul> <li>PowerShell script blocks containing encoded or obfuscated commands</li> <li>PowerShell downloading content from external URLs</li> <li>Execution of in-memory payloads</li> </ul>"},{"location":"detections/suspicious-powershell/suspicious-powershell-detection/#5-mitre-attck-mapping","title":"5. MITRE ATT&amp;CK Mapping","text":"Tactic Technique Execution T1059.001 \u2013 PowerShell Defense Evasion Obfuscated Files or Information Command and Control Application Layer Protocol"},{"location":"detections/suspicious-powershell/suspicious-powershell-detection/#6-severity-classification","title":"6. Severity Classification","text":"Scenario Severity Encoded commands High External script download High Administrative scripts Medium Known IT automation Low"},{"location":"detections/suspicious-powershell/suspicious-powershell-detection/#7-sample-event-details","title":"7. Sample Event Details","text":""},{"location":"detections/suspicious-powershell/suspicious-powershell-detection/#event-id-4104-script-block-logged","title":"Event ID 4104 \u2013 Script Block Logged","text":"<p>Important fields: - <code>ScriptBlockText</code> - <code>User</code> - <code>HostApplication</code> - <code>CommandLine</code></p>"},{"location":"detections/suspicious-powershell/suspicious-powershell-detection/#8-false-positives","title":"8. False Positives","text":"<p>Common benign causes: - IT automation scripts - Configuration management tools - Administrative troubleshooting</p>"},{"location":"detections/suspicious-powershell/suspicious-powershell-detection/#reduction-techniques","title":"Reduction Techniques","text":"<ul> <li>Whitelist known scripts</li> <li>Filter trusted paths</li> <li>Exclude known admin accounts</li> </ul>"},{"location":"detections/suspicious-powershell/suspicious-powershell-detection/#9-investigation-playbook","title":"9. Investigation Playbook","text":"<p>Analyst steps: 1. Review the script block content 2. Identify encoded or obfuscated commands 3. Check source URL or IP address 4. Determine user context (admin vs standard user) 5. Check for follow-on activity (downloads, process creation)</p>"},{"location":"detections/suspicious-powershell/suspicious-powershell-detection/#10-response-actions","title":"10. Response Actions","text":""},{"location":"detections/suspicious-powershell/suspicious-powershell-detection/#immediate","title":"Immediate","text":"<ul> <li>Isolate affected endpoint</li> <li>Terminate malicious PowerShell process</li> <li>Block malicious domains/IPs</li> </ul>"},{"location":"detections/suspicious-powershell/suspicious-powershell-detection/#follow-up","title":"Follow-up","text":"<ul> <li>Reset affected user credentials</li> <li>Scan endpoint for persistence</li> <li>Review historical PowerShell activity</li> </ul>"},{"location":"detections/suspicious-powershell/suspicious-powershell-detection/#11-detection-limitations","title":"11. Detection Limitations","text":"<ul> <li>Obfuscation may bypass simple keyword detection</li> <li>Legitimate admin scripts may appear suspicious</li> <li>Script block logging must be enabled</li> </ul>"},{"location":"detections/suspicious-powershell/suspicious-powershell-detection/#12-improvement-ideas","title":"12. Improvement Ideas","text":"<ul> <li>Add regex-based detection</li> <li>Correlate with Sysmon Event ID 1</li> <li>Add parent-child process analysis</li> <li>Use command-line length heuristics</li> </ul>"},{"location":"detections/suspicious-powershell/suspicious-powershell-detection/#13-lessons-learned","title":"13. Lessons Learned","text":"<ul> <li>PowerShell visibility is critical in modern attacks</li> <li>Context is key to reducing false positives</li> <li>Combining script content with behavior improves detection accuracy</li> </ul>"},{"location":"detections/windows-failed-logins/failed-login-detection/","title":"Windows Failed Login Brute-Force Detection","text":""},{"location":"detections/windows-failed-logins/failed-login-detection/#1-overview","title":"1. Overview","text":"<p>This detection identifies potential brute-force authentication attempts against Windows systems by analyzing repeated failed login events. Brute-force attacks are commonly used by attackers to gain initial access to corporate environments.</p> <p>This detection is designed for a SOC environment and focuses on accuracy, investigation context, and response readiness.</p>"},{"location":"detections/windows-failed-logins/failed-login-detection/#2-detection-objective","title":"2. Detection Objective","text":"<ul> <li>Identify repeated failed login attempts</li> <li>Detect possible password guessing or brute-force attacks</li> <li>Enable analysts to respond before account compromise occurs</li> </ul>"},{"location":"detections/windows-failed-logins/failed-login-detection/#3-log-sources","title":"3. Log Sources","text":"Source Description Windows Security Log Authentication events Sysmon (Optional) Process context for lateral movement <p>Required Event IDs: - 4625 \u2013 An account failed to log on - 4624 \u2013 An account was successfully logged on</p>"},{"location":"detections/windows-failed-logins/failed-login-detection/#4-detection-logic","title":"4. Detection Logic","text":"<p>Trigger an alert when: - 5 or more Event ID 4625 - From the same source IP address - Targeting the same user account - Within a 5-minute time window</p>"},{"location":"detections/windows-failed-logins/failed-login-detection/#correlation-logic","title":"Correlation Logic","text":"<ul> <li>If 4624 occurs shortly after multiple 4625 events for the same user \u2192 High severity</li> <li>If failures target multiple users \u2192 Password spray behavior</li> </ul>"},{"location":"detections/windows-failed-logins/failed-login-detection/#5-mitre-attck-mapping","title":"5. MITRE ATT&amp;CK Mapping","text":"Tactic Technique Credential Access T1110 \u2013 Brute Force Initial Access Valid Accounts"},{"location":"detections/windows-failed-logins/failed-login-detection/#6-severity-classification","title":"6. Severity Classification","text":"Scenario Severity Multiple failures, no success Medium Failures followed by success High Internal service account Low (possible false positive)"},{"location":"detections/windows-failed-logins/failed-login-detection/#7-sample-event-details","title":"7. Sample Event Details","text":""},{"location":"detections/windows-failed-logins/failed-login-detection/#event-id-4625-failed-logon","title":"Event ID 4625 \u2013 Failed Logon","text":"<p>Common fields: - <code>AccountName</code> - <code>IpAddress</code> - <code>LogonType</code> - <code>FailureReason</code></p>"},{"location":"detections/windows-failed-logins/failed-login-detection/#event-id-4624-successful-logon","title":"Event ID 4624 \u2013 Successful Logon","text":"<p>Used to confirm: - Account compromise - Successful brute-force attempts</p>"},{"location":"detections/windows-failed-logins/failed-login-detection/#8-false-positives","title":"8. False Positives","text":"<p>Possible benign causes: - User forgot password - Misconfigured services - Vulnerability scanners - Password expiration events</p>"},{"location":"detections/windows-failed-logins/failed-login-detection/#reduction-techniques","title":"Reduction Techniques","text":"<ul> <li>Exclude known service accounts</li> <li>Ignore internal vulnerability scanning IPs</li> <li>Raise threshold for internal traffic</li> </ul>"},{"location":"detections/windows-failed-logins/failed-login-detection/#9-investigation-playbook","title":"9. Investigation Playbook","text":"<p>Analyst steps: 1. Identify affected user account 2. Review source IP reputation 3. Check if login eventually succeeded 4. Review recent password changes 5. Check for lateral movement indicators</p>"},{"location":"detections/windows-failed-logins/failed-login-detection/#10-response-actions","title":"10. Response Actions","text":""},{"location":"detections/windows-failed-logins/failed-login-detection/#immediate","title":"Immediate","text":"<ul> <li>Disable or lock affected account</li> <li>Block source IP (if external)</li> <li>Force password reset</li> </ul>"},{"location":"detections/windows-failed-logins/failed-login-detection/#follow-up","title":"Follow-up","text":"<ul> <li>Review account activity</li> <li>Check for persistence mechanisms</li> <li>Document incident findings</li> </ul>"},{"location":"detections/windows-failed-logins/failed-login-detection/#11-detection-limitations","title":"11. Detection Limitations","text":"<ul> <li>Cannot detect very slow brute-force attempts</li> <li>Password spraying across long time windows may evade detection</li> <li>VPN usage may mask attacker IPs</li> </ul>"},{"location":"detections/windows-failed-logins/failed-login-detection/#12-improvement-ideas","title":"12. Improvement Ideas","text":"<ul> <li>Add GeoIP-based detection</li> <li>Combine with MFA failure logs</li> <li>Add behavioral baselines per user</li> </ul>"},{"location":"detections/windows-failed-logins/failed-login-detection/#13-lessons-learned","title":"13. Lessons Learned","text":"<ul> <li>Authentication logs are critical for early detection</li> <li>Correlation between failures and successes improves confidence</li> <li>Context reduces alert fatigue in SOC environments</li> </ul>"}]}